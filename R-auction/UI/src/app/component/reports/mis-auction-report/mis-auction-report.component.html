<div class="container-fluid whitebg border-bottom">		
    <div class="py-3">
        <form [formGroup]="misService.misqueryForm" autocomplete="off"  (ngSubmit)="misService.initTo()">
            <div class="row font14">
                <div class="col-md-1">
                    <button style="margin-top: .59em;margin-bottom: 1.05em;" type="button" 
                        class="btn btn-sm btn-primary ml-2" matTooltip="Column Menu"
                        (click)="reportService.openMISMenuPopup();">
                            <i class="fas fa-bars item-btn"></i>
                    </button> 
                    <div  style="position: absolute;top: 0;right: 0; height: 100%;" class="vertical-line align-self-stretch darkgraybg mx-2 pad-hide"></div>
                </div>
                <div class="col-md-2">
                    <mat-form-field class="full-width">
                        <input matInput readonly [matDatepicker]="dtStart" placeholder="From Date"  [max]="maxDte" formControlName="openDate"
                        (dateChange)="onfromDateChanged($event)">
                        <mat-datepicker-toggle matSuffix [for]="dtStart"></mat-datepicker-toggle>
                        <mat-datepicker #dtStart></mat-datepicker>
                        <span *ngIf="misService.misqueryForm.controls.openDate.value" style="cursor:pointer; position: absolute;top: 5px;right: 3px;font-size: 18px;color: red;" (click)="clearFromDate()"> x </span>
                        <mat-hint *ngIf="misService.miserror.startDateErrors" style="color:red;">Open date must be a future date</mat-hint>
                    </mat-form-field>
                </div>
                <div class="col-md-2">
                    <mat-form-field class="full-width">
                        <input matInput readonly [matDatepicker]="dtEnd" placeholder="To Date" [min]="minDte" formControlName="endDate" 
                        (dateChange)="onDateChang($event)">
                        <mat-datepicker-toggle matSuffix [for]="dtEnd"></mat-datepicker-toggle>
                        <mat-datepicker #dtEnd></mat-datepicker>
                        <span  *ngIf="misService.misqueryForm.controls.endDate.value"  style="cursor:pointer; position: absolute;top: 5px;right: 3px;font-size: 18px;color: red;" (click)="clearToDate()"> x </span>
                        <mat-hint *ngIf="misService.miserror.endDateErrors" style="color:red;">Close date must be a future date from open date</mat-hint>
                    </mat-form-field>
                </div>
                <div class="col-md-1">
                    <button style="margin-top: .7em;" type="submit" class="btn btn-sm btn-primary ml-2" >
                        GO
                    </button>
                </div>

                 <!-- Excel Type-->
                 <div class="col-xs-2" style="position: relative;">
                    <div  style="float: left; height: 100%;" class="vertical-line align-self-stretch darkgraybg mx-2 pad-hide"></div>
                    <mat-form-field >
                        <mat-label>Excel Type :</mat-label>
                        <mat-select  formControlName="excelType">
                            <mat-option *ngFor="let etype of misService.misexcelTypeList; let i = index;" [value]="etype">
                                {{ etype.name}}
                            </mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
                <!-- Generate Report -->
                <div class="col-sm-1" style="padding-left: 19px;">
                  <div  style="float: left; height: 100%;" class="vertical-line align-self-stretch darkgraybg mx-2 pad-hide"></div>

                    <div class="text-right">
                        <button style="margin-top: .5em;margin-bottom: 1.05em;" type="button"
                                class="btn btn-sm btn-primary ml-2" matTooltip="Generate Report"
                                (click)="downloadmis()"
                            [disabled]="downButtt">
                            <i class="fas fa-chart-line"></i>
                        </button>
                    </div>
                </div>
                <!-- Report Geneartion Status-->
                <div class="col-xs-1">
                  <div class="text-right">
                      <button style="margin-top: .5em;margin-bottom: 1.05em;" type="button"
                              class="btn btn-sm btn-primary ml-2" matTooltip="Report Generation Status"
                              (click)="checkMisReportStatus()"
                          >
                          <i class="fa fa-file"></i>
                      </button>
                  </div>
              </div>


            </div>
            
        </form>
    </div>
</div>

<div class="container-fluid page-scroll my-report" style="padding-top: 1px;background: white;">		
    <div class="mt-3">
        <div class="table-ofh table-responsive fixtable-height">
            <table class="table table-bordered font14">
                <thead>
                    <tr class="blue-header">
                        <th>S.No</th> 
                        <th *ngFor="let titleInstance of misService.misdefaultAuction" [ngClass]="{'minWidth200': titleInstance.fieldName == 'auctionName', 'minWidth102': (titleInstance.fieldName == 'startDate' || titleInstance.fieldName == 'endDate' ) }"> {{titleInstance.label}}</th>
                        <th style="padding: 0px;padding-bottom: 16px;">                            
                            <button class="header-sm-btn-ico" style="width: 50px;color: white; " 
                             matTooltip="View/Close All Items" (click)="openCloseAllMisSubHeading()">
                                Action 
                                <i class="fas fa-eye" *ngIf="!misService.misShowAll"> </i>
                                <i class="fa fa-eye-slash"  *ngIf="misService.misShowAll" ></i>
                            </button>
                        </th>
                    </tr>
                </thead> 
                
                <tbody >
                    <ng-container *ngFor="let auction of misService.reportData.auctionList; let i = index">
                        <tr [ngClass]="{'myStyle': 0 === i % 2, 'yourStyle': 0 !== i % 2 }">
                            <td >{{i+1+ ((misService.reportData.pageIndex-1) * misService.reportData.pageSize) }}</td>
                            <td *ngFor="let titleInstance of misService.misdefaultAuction">
                                {{ misService.isTypeDate(titleInstance.fieldName) ? reportService.dateAndTime2(auction[titleInstance.fieldName]) : auction[titleInstance.fieldName]}}
                            </td>
                            <td>
                                <button class="header-sm-btn-ico mr-2"  matTooltip="View Items" (click)="openItem1(auction)">
                                    <i class="fas fa-eye" *ngIf="!auction.open"> </i>
                                    <i class="fa fa-eye-slash" *ngIf="auction.open"></i>
                                </button>                    
                            </td>
                        </tr>
                        <tr  [ngClass]="{'myStyle': 0 === i % 2, 'yourStyle': 0 !== i % 2}" *ngIf="auction.open">
                            <td style="border-right: 1px solid #ffffff; border-bottom: 1px solid #5f5f5f;"></td>
                            <td style="border-right: 1px solid #ffffff; border-bottom: 1px solid #5f5f5f;" [attr.colspan]="misService.misdefaultAuction.length" >
                               
                                <div class="table-ofh table-responsive fixtable-height my-2">
                                    <table class="table table-bordered font14 whitebg mb-0 "  [ngClass]="0 === i % 2 ? 'myStyleChild' : 'yourStyleChild'" >
                                        <thead  style="font-size: 13px;">
                                            <tr class="fixed-header">
                                                <th>S.No</th>
                                                <th *ngFor="let titleInstance of misService.misdefaultItem"> {{titleInstance.label}}</th>
                                            </tr>
                                        </thead>
                                        <tbody  style="font-size: 13px;">
                                            <ng-container *ngFor="let itemObj of auction.items; let i = index">
                                                <tr>
                                                    <td>{{i+1}}</td>
                                                    <td *ngFor="let titleInstance of misService.misdefaultItem">
                                                        {{ misService.isTypeDate(titleInstance.fieldName) ? reportService.dateAndTime2(itemObj[titleInstance.fieldName]) : itemObj[titleInstance.fieldName]}}
                                                    </td>
                                                </tr>
                                            </ng-container>
                                            <tr *ngIf="auction.items.length == 0">
                                                <td [attr.colspan]="misService.misdefaultItem.length + 1" style="text-align: center;">
                                                No records found
                                                </td>
                                            </tr>                    
                                        </tbody>
                                    </table>
                                </div>                                
                            </td>
                            <td style="border-bottom: 1px solid #5f5f5f;"></td>
                        </tr>
                    </ng-container>
                    <tr *ngIf="misService.reportData.auctionList.length == 0">
                        <td [attr.colspan]="misService.misdefaultAuction.length+2" style="text-align: center;">
                        No records found
                        </td>
                    </tr>                    
                </tbody>
            </table> 
        </div>
    </div>
</div>

<div *ngIf="misService.reportData.auctionList.length > 0" class="container-fluid page-scroll whitebg">		
    <div class="pb-3">
        <mat-paginator 
            (page)="onPaginatorClick($event)" 
            [length]="misService.reportData.totalRecord" 
            [pageSize]="misService.reportData.pageSize" [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
    </div>
</div>

