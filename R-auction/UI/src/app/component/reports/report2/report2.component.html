<div class="container-fluid" style=" margin-top: -3.5rem;">
	<div class="text-right">

    <!-- Generate Report -->
    <button style="margin-top: .5em;margin-bottom: 1.05em;" type="button" class="btn btn-sm btn-primary ml-2"
      matTooltip="Generate Report" (click)="getExcelReport()" [disabled]="downButt">
      <i class="fas fa-chart-line"></i>
    </button>
	</div>
</div>

<div class="container-fluid page-scroll my-report">
	<div>
		<h4 style="cursor: pointer;margin-bottom: 10px; display: inline-block;"  (click)="showHeaderMenu()">
			<i class="fas fa-bars item-btn"></i>
			Header

		</h4>
		<span  *ngFor="let header of headerValues; let i = index">
			<div *ngIf="i == 0 || (i)%4 == 0" class="row font14">
				<div *ngIf="headerValues[i]" class="col-md-3" >
					<div class="printViewBox">
						<strong>{{headerValues[i].field.replace("I D", "Id")}}: </strong>
						<span> {{headerValues[i].value}}</span>
					</div>
				</div>
				<div *ngIf="headerValues[i+1]" class="col-md-3" >
					<div class="printViewBox">
						<strong>{{headerValues[i+1].field.replace("I D", "Id")}}: </strong>
						<span> {{headerValues[i+1].value}}</span>
					</div>
				</div>
				<div  *ngIf="headerValues[i+2]" class="col-md-3" >
					<div class="printViewBox">
						<strong>{{headerValues[i+2].field.replace("I D", "Id")}}: </strong>
						<span> {{headerValues[i+2].value}}</span>
					</div>
				</div>
				<div  *ngIf="headerValues[i+3]" class="col-md-3" >
					<div class="printViewBox">
						<strong>{{headerValues[i+3].field.replace("I D", "Id")}}: </strong>
						<span> {{headerValues[i+3].value}}</span>
					</div>
				</div>
			</div>
			<hr  *ngIf="(i == 0 || (i)%4 == 0)"> <!--  HR -->
		</span>
	</div>
	<hr  *ngIf="headerValues.length == 0"> <!--  HR -->

	<!-- Raw Data – Auction ID -->
	<div class="mt-3">
		<h4 style="cursor: pointer;margin-bottom: 10px; display: inline-block;"   (click)="showItemMenu()">
			<i class="fas fa-bars item-btn"></i>
			Raw Data – Auction Id : {{auctionID}}
		</h4>
		<div class="analyze-sb table-responsive table-scroll fix-header">
			<table *ngIf="itemRawDataList" class="table table3 table-bordered font14">
				<thead>
					<tr>
						<th [attr.rowspan]="2">Sr. No.</th>
						<th [attr.rowspan]="2">Item code</th>
						<th [attr.rowspan]="2">Item Name</th>
						<th [attr.rowspan]="2">Reliance Quantity</th>
						<th [attr.rowspan]="2">UOM</th>
						<!-- Custom fields-->
						<ng-container  *ngFor="let col of custColNames">
							<th  *ngIf="col.selected"  [attr.rowspan]="2">{{ r2Service.camelToTitle(col.fieldName) }}</th>
						</ng-container>
						<!-- Regular Fields-->
						<ng-container  *ngFor="let col of itemColumnNames" >
							<th  *ngIf="col.selected" [attr.rowspan]="2">{{ r2Service.camelToTitle(col.fieldName).replace("I D", "Id") }}</th>
						</ng-container>

						<!-- Suppliers -->
						<ng-container  *ngFor="let supplier of supplierColumnNames;let i=index;" >
							<th *ngIf="supplier.selected" [attr.colspan]="suppColSpan">{{ r2Service.camelToTitle(supplier.fieldName) }}</th>
						</ng-container>
					</tr>
					<tr>
						<!-- Supplier sub-column -->
						<ng-container *ngFor="let supplier of supplierColumnNames">
							<ng-container  *ngIf="supplier.selected">
								<ng-container  *ngFor="let subColName of supplierSubColumnNames" >
									<th *ngIf="subColName.fieldName === 'preliminaryBid' && subColName.selected">Preliminary Bid</th>
									<th *ngIf="subColName.fieldName === 'initialBid' && subColName.selected">Initial Bid - Auction </th>
									<th *ngIf="subColName.fieldName === 'lastBid' && subColName.selected">Last Bid - Auction</th>
								</ng-container>
							</ng-container>
						</ng-container>
					</tr>
				</thead>
				<tbody>
					<tr *ngFor="let item of itemRawDataList;let i=index;">
						<td>{{i+1}}</td>
						<td>{{item.itemRows.itemCode}}</td>
						<td>{{item.itemRows.itemName}}</td>
						<td>{{item.itemRows.minimumDesiredQuantity}}</td>
						<td>{{item.itemRows.unitOfMeasure}}</td>
						<!-- Only Custom Fields-->
						<ng-container *ngFor="let col of custColNames">
							<ng-container *ngFor="let custCol of item.customFieldData">
								<td *ngIf="custCol.name == col.fieldName && col.selected">{{custCol.value}}</td>
							</ng-container>
								<td  *ngFor="let custCol of item.customFieldData[col.fieldName]" >{{custCol.value}}</td>
						</ng-container>
						<!-- Regular Fields-->
						<ng-container  *ngFor="let col of itemColumnNames" >
							<td *ngIf="col.selected">{{ r2Service.formatValue(col.fieldName, item.itemRows) }}</td>
						</ng-container>

						<!-- Suppliers -->
						<ng-container *ngFor="let sup of item.supplierWiseBid; let s=index;">
							<ng-container *ngFor="let colName of supplierColumnNames">
								<ng-container *ngIf="colName.fieldName === sup.vendorName && colName.selected">
									<ng-container *ngFor="let subColName of supplierSubColumnNames">
										<td *ngIf="subColName.selected"> {{sup[subColName.fieldName]}}</td>
									</ng-container>
								</ng-container>
							</ng-container>
						</ng-container>
					</tr>
				</tbody>
			</table>
		</div>
	</div>
</div>

<ng-template #thTelmpate2 let-supplier="supplier">
	<th>Preliminary Bid</th>
	<th>Initial Bid - Auction </th>
	<th>Last Bid - Auction</th>
</ng-template>
